clear
N=4010;dx=0.0024
dt=0.0005;c=dt*dt/dx/dx;
x=linspace(0,1,420);
u(1:420,1)=0;
u(181:240,1)=0.05*sin(7*pi*x(181:240));
u(2:419,2)=u(2:419,1)+c/2*(u(3:420,1)-2*u(2:419,1)+u(1:418,1));
h=plot(x,u(:,1),'linewidth',3);
axis([0,1,-0.05,0.05]);


for k=2:N
    set(h,'Xdata',x,'Ydata',u(:,2));
    drawnow;
    u(2:419,3)=2*u(2:419,2)-u(2:419,1)+c*(u(3:420,2)-2*u(2:419,2)+u(1:418,2));
    u(2:419,1)=u(2:419,2);
    u(2:419,2)=u(2:419,3);
end